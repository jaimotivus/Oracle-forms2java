	------------------------------------------------------
	--fObtenerSaldo
	------------------------------------------------------	
	Function fObtenerSaldo( pSiniestro	Sint_Movimientos_Coberturas_Ce.Smcc_Sims_Sisi_Nu_Siniestro%Type,
													pSucursal   Sint_Movimientos_Coberturas_Ce.Smcc_Sicc_Casu_Cd_Sucursal%Type ,
													pCobertura  Sint_Movimientos_Coberturas_Ce.Smcc_Sicc_Cacb_Cd_Cobertura%Type,
													pRamoCont   Sint_Movimientos_Coberturas_Ce.Smcc_Sicc_Carb_Cd_Ramo%Type		 ) Return Number Is
		lnSaldo  		Number 	:= 0;
		lnMtoMovto	Number 	:= 0;
		lnPago   		Number 	:= 0;
		ldFeDesde 	Date 		:= sysdate;
		lnTpPago    sint_deducible_coaseguro.sidc_sitp_tp_pago%Type := 3;
		lnEgre_700  sint_liquidaciones.sili_cjte_cd_egreso%Type			:= 700;
		lnEgre_750  sint_liquidaciones.sili_cjte_cd_egreso%Type			:= 750;		
		lvTipoPago  sint_deducible_coaseguro.sidc_sitp_tp_pago%Type := 57;  
	Begin                    
    --
    SELECT nvl(sum(z.smcc_mt_movimiento ),0)
      INTO lnMtoMovto
      FROM sint_movimientos_coberturas_ce z
     WHERE z.smcc_sims_casu_cd_sucursal   = pSucursal 
       AND z.smcc_sims_sisi_nu_siniestro  = pSiniestro
       AND z.Smcc_Sicc_Cacb_Cd_Cobertura 	= pCobertura
       AND z.Smcc_Sicc_Carb_Cd_Ramo				= pRamoCont
       AND z.smcc_sims_tp_movimiento NOT IN ('IC','CC','ID')       
       AND TRUNC(z.smcc_sims_fe_movimiento) <= ldFeDesde;
    --                 
    SELECT NVL(sum((NVL(a.slcc_mt_liquidacion,0) - 
                    NVL(x.sidc_mt_pago,0))),0) liquida
      INTO lnPago
      FROM sint_liquidacion_coberturas_ce a
         , sint_liquidaciones b
         , sint_deducible_coaseguro x
     WHERE a.slcc_sili_casu_cd_sucursal  = pSucursal
       AND a.slcc_sili_sisi_nu_siniestro = pSiniestro
       AND a.slcc_sicc_cacb_cd_cobertura = pCobertura
       AND a.slcc_Sicc_Carb_Cd_Ramo			 = pRamoCont
       AND b.sili_sisi_casu_cd_sucursal  = a.slcc_sili_casu_cd_sucursal
       AND b.sili_sisi_nu_siniestro      = a.slcc_sili_sisi_nu_siniestro
       AND b.sili_nu_liquidacion         = a.slcc_sili_nu_liquidacion
       AND b.sili_cjte_cd_egreso 	 between lnEgre_700 and lnEgre_750
       AND TRUNC(b.sili_fe_pago) 			 	<= ldFeDesde 
       AND x.sidc_casu_cd_sucursal(+)    = a.slcc_sili_casu_cd_sucursal
       AND x.sidc_sisi_nu_siniestro(+)   = a.slcc_sili_sisi_nu_siniestro
       AND x.sidc_sili_nu_liquidacion(+) = a.slcc_sili_nu_liquidacion          
       AND x.sidc_cacb_carb_cd_ramo(+)   = a.slcc_sicc_carb_cd_ramo
       AND x.sidc_cacb_cd_cobertura(+)   = a.slcc_sicc_cacb_cd_cobertura
       AND b.SILI_TP_PAGO	NOT IN ('Y','Z') 
       AND x.sidc_sitp_tp_pago(+)        = lnTpPago;
	  -- Calcular saldo
	  lnSaldo := (lnMtoMovto) - abs(nvl(lnPago,0));
    --         
    
    Return lnSaldo;    
	Exception
    When No_Data_Found Then
			Return lnSaldo;	 
	End fObtenerSaldo;	